<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<link rel="stylesheet" href="__PUBLIC__/wang/common_css/reset.css">
	<link rel="stylesheet" href="__PUBLIC__/wang/upload/upload.css">
	<title>上传凭证</title>
</head>
<body>
	<header>
		<a href="{:U('Account/index')}"><img src="__PUBLIC__/wang/common_img/backimg.png" alt="">我的账户</a>
		<p>上传凭证</p>
	</header>
	<div class="way">
		<p>选择充值方式</p>
		<volist name="pay" id="pa">
		<input type="radio"  name='way' data-id="{$pa['id']}"><label >{$pa['name']}</label>

		</volist>
	</div>
	<input type="hidden" name="image_url" value="">
	<div class="money">
		<p>填写充值的阿纳豆</p>
		<input type="text" placeholder="请填写充值的阿纳豆" name="money">
		<div class="upload"><span>+</span><span>点击左边按钮上传凭证</span><input type="file" id="fileUpload"  name="img"></div>
		<div class="huixian">

		</div>
	</div>
	<footer id="ok">
		确认
	</footer>
	<script src="__PUBLIC__/js/jquery-1.11.2.min.js" type="text/javascript"></script>
	<script src='__PUBLIC__/wang/common_js/zepto.min.js'></script>
	<script src='__PUBLIC__/wang/common_js/auto-size.js'></script>
	<script src='__PUBLIC__/wang/layerMobile/layer.js'></script>
	<script src="__PUBLIC__/js/jquery.html5upload.js"></script>
	<script src='__PUBLIC__/wang/upload/upload.js'></script>
	<script>
		var top=$('body').height()-$('#ok').height();
		$('#ok').css({
			top:top
		})
	</script>
<script>
	$(function(){
		//>> 上传
		$("#fileUpload").h5upload({
			url: location.protocol+'//'+window.location.host+'/Account/upToQiniu',
			fileObjName: 'image',
			fileTypeExts: 'jpg,png,gif,bmp,jpeg',
			multi: false,
			fileSizeLimit: 1024 * 1024 * 1024 * 20,
			formData: {
				type: 'card_positive'
			},
			onUploadProgress: function (file, uploaded, total) {
				layer.open({
					type: 2
					,content: '上传中'
					,time:5
				});
			},
			onUploadSuccess: function (file, data) {
				data = $.parseJSON(data);
				if (data.status == 0) {
					layer.open({
						type: 2
						,content: '上传失败'
						,time:1
					});
				} else {
					var _isMax = false;
					var path = data.url;
					$('input[name = image_url]').val(path);
					$('.huixian').css({
						'display':'block',
						'backgroundImage':'url('+path+')'
					});
					layer.open({
						type: 2
						,content: '上传成功'
						,time:1
					});
				}
			},
			onUploadError: function (file) {
				layer.open({
					type: 2
					,content: '上传失败'
					,time:1
				});
			}
		});
	});
</script>
</body>
</html>